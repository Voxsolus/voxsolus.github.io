<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Room Time Calculator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    /* Base Styles */
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background: #f9f9f9;
      color: #000;
      transition: background 0.3s, color 0.3s;
    }

    h2 {
      text-align: center;
      margin-bottom: 20px;
    }

    /* Toggle Switch Container */
    .toggle-container {
      position: absolute;
      top: 15px;
      right: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .toggle-container label {
      font-size: 0.9em;
      font-weight: bold;
    }

    /* Toggle Switch Styling */
    .switch {
      position: relative;
      display: inline-block;
      width: 50px;
      height: 26px;
    }

    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      transition: 0.4s;
      border-radius: 34px;
    }

    .slider:before {
      position: absolute;
      content: "";
      height: 20px;
      width: 20px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: 0.4s;
      border-radius: 50%;
    }

    input:checked + .slider {
      background-color: #4caf50;
    }

    input:checked + .slider:before {
      transform: translateX(24px);
    }

    /* Banner Styling (keeps original structure + decorative elements inside it) */
    .banner {
      text-align: center;
      margin-bottom: 20px;
    }

    .banner img {
      max-width: 100%;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    }

    /* Decorative birthday content inside banner - added */
    .birthday-banner {
      padding: 18px;
      border-radius: 10px;
      background: linear-gradient(135deg,#ffecd2 0%, #fcb69f 100%);
      color: #1b1b1b;
      position: relative;
      overflow: hidden;
      box-shadow: 0 6px 18px rgba(0,0,0,0.12);
      display: inline-block;
      min-width: 280px;
    }

    .birthday-title {
      font-size: 1.4rem;
      margin: 0 0 8px;
      font-weight: 700;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .birthday-countdown {
      display: block;
      font-size: 1.1rem;
      font-weight: 700;
      letter-spacing: 0.5px;
      text-shadow: 0 2px 6px rgba(0,0,0,0.15);
    }

    /* small confetti pieces â€” limited and lightweight */
    .confetti-piece {
      position: absolute;
      width: 8px;
      height: 10px;
      opacity: 0.95;
      transform-origin: center;
      pointer-events: none;
      will-change: transform, opacity;
      animation: confetti-fall linear infinite;
    }

    @keyframes confetti-fall {
      0% { transform: translateY(-10px) rotate(0deg); opacity: 1; }
      100% { transform: translateY(220px) rotate(360deg); opacity: 0; }
    }

    /* Room entry & rest of your original CSS kept exactly as provided */
    .room-entry {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px;
      margin-bottom: 15px;
      background: #fff;
      border: 1px solid #ddd;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
      flex-wrap: wrap;
      transition: background 0.3s, color 0.3s;
    }

    .room-label {
      flex: 1 1 100%;
      font-weight: bold;
      font-size: 1.1em;
      margin-bottom: 10px;
    }

    .input-group {
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .input-group input[type="number"] {
      width: 60px;
      padding: 6px;
      background-color: yellow;
      text-align: center;
      font-size: 1em;
      border: 1px solid #ccc;
      border-radius: 4px;
      appearance: textfield;
    }

    .input-group button {
      background: #ddd;
      border: 1px solid #aaa;
      cursor: pointer;
      padding: 6px 10px;
      font-size: 16px;
      border-radius: 4px;
      transition: background 0.2s;
    }

    .input-group button:hover {
      background: #ccc;
    }

    .details {
      margin-top: 8px;
      font-size: 0.95em;
    }

    .total-time {
      margin-top: 30px;
      padding: 15px;
      background: #fff;
      border: 2px solid #4caf50;
      border-radius: 8px;
      text-align: center;
      font-weight: bold;
      font-size: 1.2em;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      transition: background 0.3s, color 0.3s;
    }

    /* Custom Room Controls */
    #custom-section {
      margin-top: 30px;
    }

    .custom-controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      gap: 15px;
    }

    .custom-controls button {
      background: #4caf50;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 14px;
    }

    .delete-btn {
      background: #ff4d4d;
      border: none;
      color: white;
      padding: 5px 10px;
      margin-top: 5px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 0.9em;
    }

    .delete-btn:hover {
      background: #e60000;
    }

    .custom-room .time-input {
      background-color: yellow;
      font-size: 1.1em;
      font-weight: bold;
      padding: 4px 8px;
      border: 2px solid #aaa;
      border-radius: 4px;
      width: 70px;
      text-align: center;
    }

    .reset-controls {
      margin-top: 30px;
      text-align: center;
    }

    .reset-controls button {
      background: #f44336;
      color: white;
      border: none;
      padding: 10px 20px;
      font-size: 16px;
      border-radius: 6px;
      cursor: pointer;
    }

    /* Dark Mode Styles */
    body.dark {
      background: #1f1f1f;
      color: #eee;
    }

    body.dark .room-entry {
      background: #2b2b2b;
      border-color: #444;
    }

    body.dark .total-time {
      background: #333;
      border-color: #66bb6a;
    }

    body.dark .input-group button {
      background: #555;
      border-color: #777;
      color: #eee;
    }

    body.dark .custom-controls button {
      background: #388e3c;
    }

    body.dark .delete-btn {
      background: #c62828;
    }

    @media (min-width: 601px) {
      .room-entry {
        flex-wrap: nowrap;
      }
      .room-label {
        flex: 1;
        margin-bottom: 0;
      }
      .input-group {
        flex: 1;
        justify-content: center;
      }
      .details {
        flex: 1;
        text-align: right;
        margin-top: 0;
      }
    }
  </style>
</head>
<body>
  <!-- Dark/Light Mode Toggle -->
  <div class="toggle-container">
    <label>Dark Mode</label>
    <label class="switch">
      <input type="checkbox" id="theme-toggle">
      <span class="slider"></span>
    </label>
  </div>

  <h2>Room Cleaning Time Calculator</h2>

  <!-- Banner (original container preserved) -->
  <div class="banner">
    <!-- Added decorative birthday content inside the banner while keeping original banner container -->
    <div class="birthday-banner" aria-live="polite">
      <div class="birthday-title">ðŸŽ‰ Birthday Soon Tracy! ðŸŽ‚</div>
      <div class="birthday-countdown" id="birthday-countdown">Loading countdownâ€¦</div>
    </div>
  </div>

  <!-- Fixed Rooms -->
  <div class="room-entry">
    <div class="room-label">Stayover</div>
    <div class="input-group">
      <input type="number" id="stayover-rooms" value="3" min="0">
      <button onclick="adjust('stayover-rooms', 1)">+</button>
      <button onclick="adjust('stayover-rooms', -1)">âˆ’</button>
    </div>
    <div class="details">
      Time/Room: 00:10:00<br>
      Total: <span id="stayover-total">00:00:00</span>
    </div>
  </div>

  <div class="room-entry">
    <div class="room-label">Checkout</div>
    <div class="input-group">
      <input type="number" id="checkout-rooms" value="7" min="0">
      <button onclick="adjust('checkout-rooms', 1)">+</button>
      <button onclick="adjust('checkout-rooms', -1)">âˆ’</button>
    </div>
    <div class="details">
      Time/Room: 00:28:00<br>
      Total: <span id="checkout-total">00:00:00</span>
    </div>
  </div>

  <div class="room-entry">
    <div class="room-label">Double Room</div>
    <div class="input-group">
      <input type="number" id="double-room-rooms" value="0" min="0">
      <button onclick="adjust('double-room-rooms', 1)">+</button>
      <button onclick="adjust('double-room-rooms', -1)">âˆ’</button>
    </div>
    <div class="details">
      Time/Room: 00:35:00<br>
      Total: <span id="double-room-total">00:00:00</span>
    </div>
  </div>

  <!-- Custom Rooms -->
  <div id="custom-section">
    <div class="custom-controls">
      <button onclick="addCustomRoom()">+ Add Custom Room</button>
      <label>
        <input type="checkbox" id="preserve-custom"> Don't remove custom rooms on reset
      </label>
    </div>
    <div id="custom-rooms"></div>
  </div>

  <!-- Total -->
  <div class="total-time">
    Total Time: <span id="total-time">00:00:00</span>
  </div>

  <!-- Reset -->
  <div class="reset-controls">
    <button onclick="resetAll()">Reset</button>
  </div>

  <script>
    const inputs = {
      'stayover-rooms': 10,
      'checkout-rooms': 28,
      'double-room-rooms': 35
    };

    function convertMinutesToTime(mins) {
      const hours = Math.floor(mins / 60);
      const minutes = mins % 60;
      return `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:00`;
    }

    function updateTimes(save = true) {
      let totalMinutes = 0;

      for (let id in inputs) {
        const value = parseInt(document.getElementById(id).value) || 0;
        const minutes = value * inputs[id];
        totalMinutes += minutes;

        const totalId = id.replace('rooms', 'total');
        document.getElementById(totalId).textContent = convertMinutesToTime(minutes);
      }

      document.querySelectorAll('.custom-room').forEach((div) => {
        const count = parseInt(div.querySelector('.room-count').value) || 0;
        const time = div.querySelector('.time-input').value;
        const parts = time.split(':');
        const mins = parseInt(parts[0] || 0) * 60 + parseInt(parts[1] || 0);
        const total = count * mins;
        totalMinutes += total;
        div.querySelector('.custom-total').textContent = convertMinutesToTime(total);
      });

      document.getElementById('total-time').textContent = convertMinutesToTime(totalMinutes);

      if (save) saveData();
    }

    function adjust(id, amount) {
      const input = document.getElementById(id);
      let value = parseInt(input.value) || 0;
      input.value = Math.max(0, value + amount);
      updateTimes();
    }

    function addCustomRoom(name = '', count = 0, time = '00:30') {
      const div = document.createElement('div');
      div.className = 'room-entry custom-room';
      div.innerHTML = `
        <div class="room-label">
          <input type="text" placeholder="Custom Room Name" value="${name}">
        </div>
        <div class="input-group">
          <input type="number" class="room-count" value="${count}" min="0">
          <button onclick="this.previousElementSibling.stepUp(); updateTimes();">+</button>
          <button onclick="this.previousElementSibling.stepDown(); updateTimes();">âˆ’</button>
        </div>
        <div class="details">
          Time/Room: <input class="time-input" value="${time}" type="text"><br>
          Total: <span class="custom-total">00:00:00</span><br>
          <button class="delete-btn" onclick="this.closest('.custom-room').remove(); updateTimes();">Delete</button>
        </div>
      `;
      div.querySelectorAll('input').forEach(input => input.addEventListener('input', updateTimes));
      document.getElementById('custom-rooms').appendChild(div);
      updateTimes();
    }

    function saveData() {
      const fixed = {};
      Object.keys(inputs).forEach(id => {
        fixed[id] = document.getElementById(id).value;
      });

      const custom = [];
      document.querySelectorAll('.custom-room').forEach(div => {
        const name = div.querySelector('input[type="text"]').value;
        const count = div.querySelector('.room-count').value;
        const time = div.querySelector('.time-input').value;
        custom.push({ name, count, time });
      });

      localStorage.setItem('roomData', JSON.stringify({ fixed, custom }));
    }

    function loadData() {
      const saved = JSON.parse(localStorage.getItem('roomData'));
      if (!saved) return;

      Object.keys(saved.fixed).forEach(id => {
        if (document.getElementById(id)) {
          document.getElementById(id).value = saved.fixed[id];
        }
      });

      saved.custom.forEach(room => {
        addCustomRoom(room.name, room.count, room.time);
      });

      updateTimes(false);
    }

    function resetAll() {
      Object.keys(inputs).forEach(id => {
        document.getElementById(id).value = 0;
      });

      if (!document.getElementById('preserve-custom').checked) {
        document.getElementById('custom-rooms').innerHTML = '';
      }

      updateTimes();
    }

    // === Theme Toggle Logic ===
    const toggle = document.getElementById('theme-toggle');
    const body = document.body;

    toggle.addEventListener('change', () => {
      if (toggle.checked) {
        body.classList.add('dark');
        localStorage.setItem('theme', 'dark');
      } else {
        body.classList.remove('dark');
        localStorage.setItem('theme', 'light');
      }
    });

    // Load saved theme
    if (localStorage.getItem('theme') === 'dark') {
      body.classList.add('dark');
      toggle.checked = true;
    }

    // === Birthday Countdown (non-invasive) ===
    function startBirthdayCountdown() {
      const target = new Date("December 3, 2025 00:00:00").getTime();
      const display = document.getElementById('birthday-countdown');

      // single interval to update clock
      const tick = () => {
        const now = Date.now();
        const diff = target - now;

        if (diff <= 0) {
          display.textContent = "ðŸŽˆ It's Tracy's Birthday Today! ðŸŽ";
          // Stop further showing negative time
          return;
        }

        const days = Math.floor(diff / (1000 * 60 * 60 * 24));
        const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((diff % (1000 * 60)) / 1000);

        // Decorative formatting but compact to avoid layout shifts
        display.textContent = `${days}d ${String(hours).padStart(2,'0')}h ${String(minutes).padStart(2,'0')}m ${String(seconds).padStart(2,'0')}s`;
      };

      tick(); // immediate
      const intervalId = setInterval(() => {
        // If countdown is over, clear interval
        if (Date.now() >= target) {
          clearInterval(intervalId);
        }
        tick();
      }, 1000);

      // Lightweight confetti generation inside banner â€” small number and non-invasive
      const banner = document.querySelector('.birthday-banner');
      if (!banner) return;
      const colors = ['#ff4d4d','#ffd700','#00e6e6','#ff66cc','#99ff33'];
      for (let i = 0; i < 14; i++) {
        const c = document.createElement('div');
        c.className = 'confetti-piece';
        c.style.backgroundColor = colors[i % colors.length];
        c.style.left = (5 + Math.random() * 90) + '%';
        c.style.top = (-5 - Math.random() * 30) + 'px';
        c.style.width = (6 + Math.random() * 8) + 'px';
        c.style.height = (8 + Math.random() * 10) + 'px';
        c.style.borderRadius = (Math.random() > 0.5 ? '2px' : '50%');
        c.style.animationDuration = (2.5 + Math.random() * 2.5) + 's';
        c.style.animationDelay = (Math.random() * 2) + 's';
        banner.appendChild(c);

        // remove after animation (cleanup)
        setTimeout(() => {
          c.remove();
        }, 8000);
      }
    }

    // Ensure original loadData and updateTimes happen before adding countdown so times are correct immediately
    loadData();
    startBirthdayCountdown();
  </script>
</body>
</html>
